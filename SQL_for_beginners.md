# SQL — объяснение для полного новичка

## Что такое база данных?

Представь **Excel-таблицу**, которая хранится на компьютере и с которой может работать программа.

У тебя есть таблица `balances` (балансы валют):

| id | currency | amount | rate |
|----|----------|--------|------|
| 1  | USD      | 100.0  | 90.5 |
| 2  | EUR      | 50.0   | 98.2 |
| 3  | RUB      | 5000.0 | 1.0  |

- **Строка** (row) — одна запись (например, вся информация про USD).
- **Столбец** (column) — одно свойство (например, `amount` у всех валют).
- **Таблица** (table) — вся "Excel-страница" целиком.
- **База данных** (database) — файл, в котором хранятся одна или несколько таблиц.

---

## Что такое SQL?

**SQL** (Structured Query Language) — это язык, которым ты **разговариваешь с базой данных**.

Ты пишешь команду (запрос) на SQL, база данных её выполняет и возвращает результат.

Аналогия: база данных — это библиотекарь. SQL — это язык, на котором ты просишь его найти, добавить или убрать книги.

---

## 4 главные команды (CRUD)

Почти всё, что ты делаешь с данными, сводится к четырём действиям:

| Действие | SQL-команда | Что делает | Аналогия |
|----------|-------------|------------|----------|
| **C**reate (создать) | `INSERT` | Добавляет новую строку | Вписать новую строку в таблицу |
| **R**ead (прочитать) | `SELECT` | Достаёт данные | Посмотреть что написано |
| **U**pdate (обновить) | `UPDATE` | Меняет существующие данные | Стереть и написать заново |
| **D**elete (удалить) | `DELETE` | Удаляет строку | Вычеркнуть строку из таблицы |

Запомни слово **CRUD** — это аббревиатура этих четырёх действий. Ты будешь слышать его постоянно.

---

## 1. SELECT — получить данные

### Получить всё из таблицы

```sql
SELECT * FROM balances;
```

- `SELECT` — «выбери/покажи»
- `*` — «все столбцы» (звёздочка = всё)
- `FROM balances` — «из таблицы balances»
- `;` — точка с запятой в конце (конец команды)

**Результат:**

| id | currency | amount | rate |
|----|----------|--------|------|
| 1  | USD      | 100.0  | 90.5 |
| 2  | EUR      | 50.0   | 98.2 |
| 3  | RUB      | 5000.0 | 1.0  |

### Получить только определённые столбцы

```sql
SELECT currency, amount FROM balances;
```

«Покажи мне только валюту и сумму»

**Результат:**

| currency | amount |
|----------|--------|
| USD      | 100.0  |
| EUR      | 50.0   |
| RUB      | 5000.0 |

### Получить с условием (WHERE)

```sql
SELECT * FROM balances WHERE currency = 'USD';
```

- `WHERE` — «где» (условие/фильтр)
- `currency = 'USD'` — «столбец currency равен USD»

**Результат:**

| id | currency | amount | rate |
|----|----------|--------|------|
| 1  | USD      | 100.0  | 90.5 |

Другие примеры условий:

```sql
-- amount больше 100
SELECT * FROM balances WHERE amount > 100;

-- rate меньше или равно 50
SELECT * FROM balances WHERE rate <= 50;

-- currency не равно RUB
SELECT * FROM balances WHERE currency != 'RUB';
```

> Строки, начинающиеся с `--`, это **комментарии** — база их игнорирует.

---

## 2. INSERT — добавить данные

```sql
INSERT INTO balances (currency, amount, rate) VALUES ('GBP', 75.0, 115.3);
```

Разбор по частям:

- `INSERT INTO balances` — «вставь в таблицу balances»
- `(currency, amount, rate)` — «в эти столбцы» (id не указываем — он создаётся автоматически)
- `VALUES ('GBP', 75.0, 115.3)` — «вот эти значения»

**Таблица после выполнения:**

| id | currency | amount | rate  |
|----|----------|--------|-------|
| 1  | USD      | 100.0  | 90.5  |
| 2  | EUR      | 50.0   | 98.2  |
| 3  | RUB      | 5000.0 | 1.0   |
| 4  | GBP      | 75.0   | 115.3 |

Заметь: `id = 4` появился сам — это `AUTOINCREMENT` (автоувеличение).

---

## 3. UPDATE — изменить данные

```sql
UPDATE balances SET amount = 200.0 WHERE id = 1;
```

- `UPDATE balances` — «обнови таблицу balances»
- `SET amount = 200.0` — «установи amount в 200»
- `WHERE id = 1` — «только для строки, где id = 1»

**Таблица после выполнения:**

| id | currency | amount | rate |
|----|----------|--------|------|
| 1  | USD      | **200.0** | 90.5 |
| 2  | EUR      | 50.0   | 98.2 |
| 3  | RUB      | 5000.0 | 1.0  |

> **ВАЖНО:** если забыть `WHERE`, обновятся **ВСЕ** строки! Это частая ошибка новичков.

```sql
-- ЭТО ОПАСНО — изменит amount У ВСЕХ строк:
UPDATE balances SET amount = 0;
```

---

## 4. DELETE — удалить данные

```sql
DELETE FROM balances WHERE id = 2;
```

- `DELETE FROM balances` — «удали из таблицы balances»
- `WHERE id = 2` — «только строку, где id = 2»

**Таблица после выполнения:**

| id | currency | amount | rate |
|----|----------|--------|------|
| 1  | USD      | 100.0  | 90.5 |
| 3  | RUB      | 5000.0 | 1.0  |

> **ВАЖНО:** как и с UPDATE — без `WHERE` удалится **ВСЁ** из таблицы!

---

## Создание таблицы (CREATE TABLE)

Прежде чем хранить данные, нужно создать таблицу — описать какие столбцы в ней будут.

```sql
CREATE TABLE IF NOT EXISTS balances (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    currency TEXT NOT NULL,
    amount REAL NOT NULL,
    rate REAL NOT NULL
);
```

Разбор по частям:

| Часть | Что значит |
|-------|-----------|
| `CREATE TABLE` | Создай таблицу |
| `IF NOT EXISTS` | Только если такой таблицы ещё нет (чтобы не было ошибки при повторном запуске) |
| `balances` | Название таблицы |
| `id INTEGER` | Столбец `id`, тип — целое число |
| `PRIMARY KEY` | Главный ключ — уникальный идентификатор каждой строки (как номер паспорта) |
| `AUTOINCREMENT` | Автоматически увеличивается: 1, 2, 3, 4... Не нужно вручную указывать |
| `currency TEXT` | Столбец `currency`, тип — текст (строка) |
| `amount REAL` | Столбец `amount`, тип — дробное число (1.5, 99.99) |
| `NOT NULL` | Обязательное поле — нельзя оставить пустым |

### Типы данных (основные)

| Тип | Что хранит | Пример |
|-----|-----------|--------|
| `INTEGER` | Целое число | 1, 42, -5 |
| `REAL` | Дробное число | 3.14, 99.99 |
| `TEXT` | Текст/строка | 'USD', 'Привет' |

---

## Почему SQL пишут ЗАГЛАВНЫМИ буквами?

Это **соглашение о стиле**, а не требование. Оба варианта работают одинаково:

```sql
-- Так принято (заглавные ключевые слова):
SELECT currency FROM balances WHERE amount > 100;

-- Так тоже работает, но читать сложнее:
select currency from balances where amount > 100;
```

Заглавные буквы помогают **визуально отличить команды SQL** (`SELECT`, `FROM`, `WHERE`) от названий таблиц и столбцов (`balances`, `currency`, `amount`).

---

## Как SQL используется в твоём Go-коде

Вот как связан SQL с кодом в `Main.go`:

```go
// Go отправляет SQL-запрос в базу данных
rows, err := db.Query("SELECT id, currency, amount, rate FROM balances")
```

Что происходит:

```
Твой Go-код                    База данных (SQLite)
     |                                |
     |--- "SELECT * FROM balances" -->|  1. Go отправляет SQL-запрос
     |                                |  2. БД ищет данные
     |<-- [строки с данными] ---------|  3. БД возвращает результат
     |                                |
     |  rows.Next() / rows.Scan()     |  4. Go читает строки по одной
```

---

## Что такое SQLite?

В твоём проекте используется **SQLite** — это самая простая база данных. Она хранит всё **в одном файле** (`balances.db`). Не нужно ничего устанавливать и настраивать — просто файл на диске.

Для сравнения:

| БД | Где работает | Для чего |
|----|-------------|----------|
| **SQLite** | Файл на диске | Учёба, мобильные приложения, маленькие проекты |
| **PostgreSQL** | Отдельный сервер | Большие веб-приложения |
| **MySQL** | Отдельный сервер | Веб-сайты, интернет-магазины |

SQL-язык одинаковый во всех — выучишь один раз, будешь пользоваться везде.

---

## Шпаргалка-итог

```
СОЗДАТЬ таблицу:    CREATE TABLE имя (столбцы...);
ДОБАВИТЬ строку:    INSERT INTO таблица (столбцы) VALUES (значения);
ПРОЧИТАТЬ данные:   SELECT столбцы FROM таблица WHERE условие;
ИЗМЕНИТЬ данные:    UPDATE таблица SET столбец = значение WHERE условие;
УДАЛИТЬ строку:     DELETE FROM таблица WHERE условие;
```

Всегда помни `WHERE` в `UPDATE` и `DELETE` — иначе изменишь/удалишь всё!
